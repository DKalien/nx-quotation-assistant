NX Open C++ 程序编译说明
================================

本程序用于提取文件夹内 .prt 文件的质量和表面积，密度设置为 7.85 g/cm³。

已为您准备好所有文件：
- Dll1.vcxproj          - Visual Studio 项目文件（已配置NX Open）
- nxopen.props          - NX Open 属性表（包含路径设置）
- extract_mass_properties.cpp - 主程序源代码
- 其他支持文件（dllmain.cpp, pch.h, pch.cpp, framework.h）

编译方法（任选其一）：
--------------------------------

方法一：使用 Visual Studio（最简单）
--------------------------------
1. 确保已安装 Visual Studio 2017 或更高版本
2. 双击 "Dll1.vcxproj" 文件，在 Visual Studio 中打开
3. 在顶部工具栏选择配置：
   - 解决方案配置：选择 "Release"
   - 解决方案平台：选择 "x64"（推荐）或 "Win32"
4. 点击菜单：生成 -> 生成解决方案 (Ctrl+Shift+B)
5. 编译成功后，在 "x64\Release" 或 "Win32\Release" 文件夹中找到 "Dll1.dll"

方法二：使用命令行（如果已安装MSBuild）
--------------------------------
1. 打开 "开发者命令提示符 for Visual Studio"
   - 在开始菜单搜索 "Developer Command Prompt"
2. 切换到当前目录：
   ```
   cd "D:\python\nx-quotation-assistant\Dll1"
   ```
3. 运行编译命令：
   ```
   msbuild Dll1.vcxproj /p:Configuration=Release /p:Platform=x64
   ```

方法三：使用批处理文件
--------------------------------
1. 双击运行 "compile.bat"（如果存在）
2. 按提示操作

重要设置说明：
--------------------------------
1. NX 安装路径：
   - 默认假设 NX 12.0 安装在 "C:\Program Files\Siemens\NX 12.0"
   - 如果安装在其他位置，需要修改 "nxopen.props" 文件中的 <NXInstallDir> 路径

2. 环境变量：
   - 如果设置了 UGII_BASE_DIR 环境变量，程序会自动使用该路径
   - 否则使用默认路径

3. 目标平台：
   - 如果您的 NX 是 32 位版本，请选择 "Win32" 平台
   - 如果您的 NX 是 64 位版本（推荐），请选择 "x64" 平台

运行程序：
--------------------------------
1. 将编译好的 "Dll1.dll" 复制到任意目录
2. 在 NX 中执行：
   - File -> Execute -> NX Open
   - 选择 "Dll1.dll"
   - 点击 OK

3. 程序会自动扫描当前文件夹内的所有 .prt 文件
4. 结果显示在 NX 信息窗口（按 Ctrl+5 打开）

常见问题：
--------------------------------
1. 编译错误 "找不到头文件"：
   - 检查 NX 安装路径是否正确
   - 修改 nxopen.props 文件中的 <NXInstallDir> 路径

2. 链接错误 "找不到 .lib 文件"：
   - 确保 NX 已安装开发组件
   - 检查 $(NXInstallDir)\ugii 目录下是否有 libufun.lib 等文件

3. 运行时无输出：
   - 确保 NX 信息窗口已打开（按 Ctrl+5）
   - 检查 .prt 文件是否在当前文件夹

4. 单位显示不正确：
   - 程序会自动检测部件单位（毫米/米/英寸/英尺）
   - 如果检测失败，默认使用毫米单位

程序功能：
--------------------------------
- 自动扫描当前文件夹内的所有 .prt 文件
- 检测部件单位系统
- 计算体积、质量和表面积
- 应用密度 7.85 g/cm³
- 输出结果包含国际单位和常用单位

输出示例：
--------------------------------
=== NX 质量属性提取器 (C++ 版本) ===
密度: 7.85 g/cm³ = 7850 kg/m³

扫描文件夹: D:\your\folder
找到 2 个 .prt 文件:
  - m.prt
  - mm.prt

处理文件: m.prt
  单位系统: 毫米
  体积: 0.000125 m³
  质量: 0.98125 kg
  表面积: 0.015 m²
  质量: 981.25 g
  表面积: 150.0 cm²

技术支持：
--------------------------------
如有问题，请提供：
1. Visual Studio 版本
2. NX 版本
3. 完整的错误信息
4. 操作系统版本